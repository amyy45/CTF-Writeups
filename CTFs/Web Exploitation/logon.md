# ðŸ§© CTF Challenge Writeup  
**Challenge Name:** logon  
**Category:** Web Exploitation  
**Difficulty:** Easy  
**Platform:** picoCTF 2019  
**Author:** BOBSON  
**Date:** 20-02-26  

---

## ðŸ” 1. Challenge Description

The challenge presents a website with the following description:

> *"The factory is hiding things from all of its users. Can you login as Joe and find what they've been looking at?"*

A login page is provided with username and password fields.  
The hint says **"Hmm it doesn't seem to check anyone's password, except for Joe's"** â€” suggesting authentication can be bypassed, and the flag is only visible to privileged users.

---

## ðŸ§  2. Initial Thoughts / Approach

Given:
- **Web Exploitation** category  
- **Easy** difficulty  
- The hint mentions Joe's password is checked but others are not
- The challenge involves logging in and finding hidden information

Key observations:
- Logging in with any username/password might work since only Joe's password is validated
- After logging in, the flag might be restricted based on user **role or privilege**
- Web applications often use **cookies** to store session and authorization data
- Cookies are fully user-controlled and can be modified in the browser
- If authorization is checked client-side via cookies, simply changing the cookie value grants access

The intended approach is to **log in with any credentials**, then **inspect and manipulate cookies** to escalate privileges.

---

## ðŸ› ï¸ 3. Steps to Solve

### 3.1 Open the Website
Navigate to:
```
http://fickle-tempest.picoctf.net:56456
```
A standard login page appears â€” **Factory Login**.

### 3.2 Login With Any Credentials
Since the hint says only Joe's password is checked, log in with any random user:
```
Username: sneha
Password: password
```
Login succeeds with the message:  
> *"Success: You logged in! Not sure you'll be able to see the flag though."*

But the page shows **"No flag for you"** â€” login worked but access is still restricted.

### 3.3 Inspect the Cookies
Press `F12` â†’ go to the **Application** tab â†’ click **Cookies** in the left sidebar.

A cookie is found:
```
admin = false
```

This means the server is checking the `admin` cookie to decide whether to show the flag.

### 3.4 Modify the Cookie
Double-click the cookie value `false` and change it to:
```
admin = true
```

### 3.5 Refresh the Page
Press `F5` to reload â€” the server now reads `admin = true` from the cookie and grants access.

The flag is displayed on the page! âœ…

---

## ðŸ§© 4. Final Flag

```
picoCTF{th3_c0nsp1r4cy_l1v3s_4d184b0d}
```

---

## ðŸ“š 5. Key Learnings

- **Cookies are fully user-controlled** â€” they can be read and modified freely in the browser
- **Never use cookies alone for authorization decisions** â€” they must be verified server-side
- An `admin = false` cookie is trivially bypassed by changing it to `admin = true`
- After logging in to a web challenge, always inspect cookies in **DevTools â†’ Application â†’ Cookies**
- Look for suspicious cookie names like `admin`, `role`, `isAdmin`, `loggedin`, `privilege`
- The server trusted the client-supplied cookie without any server-side validation â€” a classic security misconfiguration

---

## ðŸš€ 6. Improvements for Next Time

- Always check cookies **immediately** after logging in to any web challenge
- Look for boolean-style cookies (`true/false`, `0/1`, `user/admin`) â€” these are easy targets
- If the page says "No flag for you" or shows restricted content, cookie manipulation is a likely solution
- Use **DevTools â†’ Application â†’ Cookies** to view and edit cookie values without any extra tools
- Try changing `role`, `admin`, `isAdmin`, `user` cookie values before attempting complex exploits

---

## ðŸ”— 7. References

- [MDN Web Docs â€“ HTTP Cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)
- [OWASP â€“ Broken Access Control](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)
- [OWASP â€“ Session Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)
- [picoCTF Web Exploitation Challenges](https://picoctf.org)