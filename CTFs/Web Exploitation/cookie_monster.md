# üß© CTF Challenge Writeup  
**Challenge Name:** Cookie Monster Secret Recipe  
**Category:** Web Exploitation  
**Difficulty:** Easy  
**Platform:** picoCTF 2025 (picoMini by CMU-Africa)  
**Author:** BRHANE GIDAY and PRINCE NIYONSHUTI N.  
**Date:** 19-01-26  

---

## üîç 1. Challenge Description
The challenge presents a simple web page themed around the Cookie Monster.  
According to the description, the Cookie Monster has hidden his **top-secret cookie recipe** somewhere on the website.

A provided hint mentions that **web browsers have tools that allow inspection of things not directly visible**, strongly suggesting client-side analysis rather than server-side exploitation.

The objective is to locate the hidden secret (flag).

---

## üß† 2. Initial Thoughts / Approach
Given:
- **Web Exploitation** category
- **Easy** difficulty
- Explicit hint about browser tools

The likely attack surface includes:
- Cookies
- Local Storage / Session Storage
- Client-side JavaScript or HTML comments

The challenge name strongly hints that the secret is stored in **cookies**.

---

## üõ†Ô∏è 3. Steps to Solve

### 3.1 Open the Challenge Instance
The provided link launches a web application instance in the browser.
### 3.2 Open Browser Developer Tools
Using the browser‚Äôs developer tools:
- Chrome / Edge: `F12` or `Ctrl + Shift + I`
- Firefox: `F12`

Navigate to the **Application** (Chrome) or **Storage** (Firefox) tab.
### 3.3 Inspect Cookies
Under the **Cookies** section for the challenge domain, a suspicious cookie value was found.

The cookie value appeared encoded and looked similar to Base64, but also contained URL-encoded characters:

```yaml
Gljb0NURntjMDBrMWVfbTBuc3Rlcl9sMHZlc19jMDBraWVzX0IzQUQ5NEMyfQ%3D%3D
```
### 3.4 Decode the Cookie Value
First, the value was Base64-decoded directly:
```bash
echo "cGljb0NURntjMDBrMWVfbTBuc3Rlcl9sMHZlc19jMDBraWVzX0IzQUQ5NEMyfQ%3D%3D" | base64 -d
```
Output:
```bash
picoCTF{c00k1e_m0nster_l0ves_c00kies_B3AD94C2}
base64: invalid input
```
The warning occurs because:
- %3D%3D is URL-encoded ==
- Base64 decoding still succeeds for the valid portion

For a clean decode, URL-decoding first removes the warning:
```bash
echo "cGljb0NURntjMDBrMWVfbTBuc3Rlcl9sMHZlc19jMDBraWVzX0IzQUQ5NEMyfQ==" | base64 -d

---
## üß©  4. Final Flag 
```bash
picoCTF{c00k1e_m0nster_l0ves_c00kies_B3AD94C2}
```

---
## üìö 5. Key Learnings
- Sensitive data stored in cookies is not secure
- Cookies may be URL-encoded and Base64-encoded
- Browser developer tools are essential for web security testing
- Client-side storage should never be trusted for secrets
- Encoding ‚â† encryption

---
## üöÄ 6. Improvements for Next Time
- Always inspect cookies early in web challenges
- Remember to URL-decode before Base64-decoding
- Check Local Storage and Session Storage alongside cookies
- Do not overcomplicate easy web challenges
- Build a quick checklist for client-side inspection

---
## üîó 7. References
- OWASP: Web Storage Security Risks
- MDN Web Docs: HTTP Cookies
- picoCTF Web Exploitation Challenges
- PayloadsAllTheThings ‚Äì Client-Side Web Attacks