# üß© CTF Challenge Writeup  
**Challenge Name:** Cookies  
**Category:** Web Exploitation  
**Difficulty:** Easy  
**Platform:** picoCTF 2021  
**Author:** MADSTACKS  
**Date:** 30-01-26  

---

## üîç 1. Challenge Description

The challenge presents a web application with the following description:

> *‚ÄúWho doesn't love cookies? Try to figure out the best one.‚Äù*

A URL is provided that hosts a webpage related to cookies.  
No flag is displayed initially, suggesting that interaction with the application is required.

The challenge name **Cookies** strongly implies that the solution involves **inspecting and manipulating HTTP cookies**.

---

## üß† 2. Initial Thoughts / Approach

Given:
- **Web Exploitation** category  
- **Easy** difficulty  
- No hints provided  

Key observations:
- Cookies are stored client-side and sent with every HTTP request
- Applications must never trust client-controlled cookie values
- Changing cookie values can sometimes bypass logic or access restricted content

The intended approach is therefore to **inspect browser cookies** and test whether modifying them affects server behavior.

---

## üõ†Ô∏è 3. Steps to Solve

### 3.1 Launch the Challenge Instance
Open the provided URL in a web browser.

The page displays a short message about cookies, but no flag is visible.

### 3.2 Inspect Browser Cookies
Open **Developer Tools** (`Ctrl + Shift + I`) and navigate to:

- **Application ‚Üí Storage ‚Üí Cookies** (Chrome)  
- **Storage ‚Üí Cookies** (Firefox)

A cookie is found with the following name:
```text
name
```
The value is initially set to a non-privileged value.


### 3.3 Modify the Cookie Value
The cookie value is manually changed to different numeric values and the page is refreshed after each change.

This process effectively performs **manual enumeration** of server-accepted cookie values.

Eventually, the cookie is set to:
```text
name=18
```

### 3.4 Flag Disclosure
After refreshing the page with the modified cookie value, the server responds differently and displays the flag directly on the webpage:

```text
picoCTF{3v3ry1_l0v3s_c00k135_a4dadb49}
```
This confirms that the application relies on an unvalidated client-controlled cookie to determine privileged access.

---
## üß©  4. Final Flag 
```bash
picoCTF{3v3ry1_l0v3s_c00k135_a4dadb49}
```

---
## üìö 5. Key Learnings
- Cookies are fully attacker-controlled
- Server logic must never trust client-supplied values
- Authorization decisions should not be based on cookies alone
- Manual enumeration is effective in low-complexity challenges
- Browser Developer Tools are essential for web exploitation

---
## üöÄ 6. Improvements for Next Time
- Automate cookie enumeration using scripts or Burp Suite
- Validate cookies server-side using signed or encrypted values
- Monitor cookie usage via the Network tab
- Always test client-controlled inputs early
- Look for privilege escalation through state manipulation

---
## üîó 7. References
- MDN Web Docs ‚Äì HTTP Cookies
- OWASP Top 10 ‚Äì Broken Access Control
- OWASP Top 10 ‚Äì Insecure Design
- picoCTF Web Exploitation Challenges